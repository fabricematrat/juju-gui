{
  "Id": "cs:trusty/haproxy-19",
  "Meta": {
    "charm-config": {
      "Options": {
        "default_log": {
          "Type": "string",
          "Description": "Default log",
          "Default": "global"
        },
        "default_mode": {
          "Type": "string",
          "Description": "Default mode",
          "Default": "http"
        },
        "default_options": {
          "Type": "string",
          "Description": "Default options",
          "Default": "httplog, dontlognull"
        },
        "default_retries": {
          "Type": "int",
          "Description": "Set the number of retries to perform on a server after a connection\nfailure. It is important to understand that this value applies to the\nnumber of connection attempts, not full requests. When a connection \nhas effectively been established to a server, there will be no more \nretry.\nIn order to avoid immediate reconnections to a server which is \nrestarting, a turn-around timer of 1 second is applied before a retry\noccurs.\n",
          "Default": 3
        },
        "default_timeouts": {
          "Type": "string",
          "Description": "Default timeouts",
          "Default": "queue 20000, client 50000, connect 5000, server 50000"
        },
        "enable_monitoring": {
          "Type": "boolean",
          "Description": "Enable monitoring",
          "Default": false
        },
        "global_debug": {
          "Type": "boolean",
          "Description": "Debug or not",
          "Default": false
        },
        "global_default_bind_ciphers": {
          "Type": "string",
          "Description": "Sets the default string describing the list of cipher algorithms\n(\"cipher suite\") that are negotiated during the SSL/TLS handshake for\nall \"bind\" lines which do not explicitly define theirs. The format of\nthe string is defined in \"man 1 ciphers\" from OpenSSL man pages, and\ncan be for instance a string such as \"AES:ALL:!aNULL:!eNULL:+RC4:@STRENGTH\"\n(without quotes). Please check the \"bind\" keyword for more information.\nThis config key will be ignored if the installed haproxy package has no SSL\nsupport.\n",
          "Default": "ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA"
        },
        "global_default_dh_param": {
          "Type": "int",
          "Description": "Sets the maximum size of the Diffie-Hellman parameters used for generating\nthe ephemeral/temporary Diffie-Hellman key in case of DHE key exchange.\nDefault value if 1024, higher values will increase the CPU load, and values\ngreater than 1024 bits are not supported by Java 7 and earlier clients. This\nconfig key will be ignored if the installed haproxy package has no SSL support.\n",
          "Default": 1024
        },
        "global_group": {
          "Type": "string",
          "Description": "Group",
          "Default": "haproxy"
        },
        "global_log": {
          "Type": "string",
          "Description": "Global log line ( multiples ... comma separated list )",
          "Default": "/dev/log local0, /dev/log local1 notice"
        },
        "global_maxconn": {
          "Type": "int",
          "Description": "Sets the maximum per-process number of concurrent connections to\n\u003cnumber\u003e.\n",
          "Default": 4096
        },
        "global_quiet": {
          "Type": "boolean",
          "Description": "Quiet",
          "Default": false
        },
        "global_spread_checks": {
          "Type": "int",
          "Description": "Sometimes it is desirable to avoid sending health checks to servers at\nexact intervals, for instance when many logical servers are located on\nthe same physical server. With the help of this parameter, it becomes \npossible to add some randomness in the check interval between 0 and \n+/- 50%. A value between 2 and 5 seems to show good results.\n",
          "Default": 0
        },
        "global_stats_socket": {
          "Type": "boolean",
          "Description": "Whether to enable the stats UNIX socket.\n",
          "Default": false
        },
        "global_user": {
          "Type": "string",
          "Description": "User",
          "Default": "haproxy"
        },
        "key": {
          "Type": "string",
          "Description": "Key ID to import to the apt keyring to support use with arbitary source\nconfiguration from outside of Launchpad archives or PPA's.\n",
          "Default": ""
        },
        "metrics_prefix": {
          "Type": "string",
          "Description": "Prefix for metrics. Special value $UNIT can be used to include the\nname of the unit in the prefix.\n",
          "Default": "dev.$UNIT.haproxy"
        },
        "metrics_sample_interval": {
          "Type": "int",
          "Description": "Period for metrics cron job to run in minutes",
          "Default": 5
        },
        "metrics_target": {
          "Type": "string",
          "Description": "Destination for statsd-format metrics, format \"host:port\". If\nnot present and valid, metrics disabled. Requires \"enable_monitoring\"\nto be set to true to work.\n",
          "Default": ""
        },
        "monitoring_allowed_cidr": {
          "Type": "string",
          "Description": "CIDR allowed ( multiple CIDRs separated by space ) access to the\nmonitoring interface.\n",
          "Default": "127.0.0.1/32"
        },
        "monitoring_password": {
          "Type": "string",
          "Description": "Password to the monitoring interface ( if \"changeme\", a new password\nwill be generated and displayed in juju-log )\n",
          "Default": "changeme"
        },
        "monitoring_port": {
          "Type": "int",
          "Description": "Default monitoring port",
          "Default": 10000
        },
        "monitoring_stats_refresh": {
          "Type": "int",
          "Description": "Monitoring interface refresh interval (in seconds)",
          "Default": 3
        },
        "monitoring_username": {
          "Type": "string",
          "Description": "Monitoring username",
          "Default": "haproxy"
        },
        "nagios_context": {
          "Type": "string",
          "Description": "Used by the nrpe-external-master subordinate charm.\nA string that will be prepended to instance name to set the host name\nin nagios. So for instance the hostname would be something like:\n    juju-postgresql-0\nIf you're running multiple environments with the same services in them\nthis allows you to differentiate between them.\n",
          "Default": "juju"
        },
        "package_status": {
          "Type": "string",
          "Description": "The status of service-affecting packages will be set to this value in the dpkg database.\nUseful valid values are \"install\" and \"hold\".\n",
          "Default": "install"
        },
        "peering_mode": {
          "Type": "string",
          "Description": "Possible values : \"active-passive\", \"active-active\". This is only used\nif several units are spawned.  In \"active-passive\" mode, all the units will\nforward traffic to the first working haproxy unit, which will then forward it\nto configured backends. In \"active-active\" mode, each unit will proxy the\ntraffic directly to the backends. The \"active-passive\" mode gives a better\ncontrol of the maximum connection that will be opened to a backend server.\n",
          "Default": "active-passive"
        },
        "services": {
          "Type": "string",
          "Description": "Services definition(s). Although the variable type is a string, this is\ninterpreted in the charm as yaml. To use multiple services within the\nsame haproxy instance, specify all of the variables (service_name,\nservice_host, service_port, service_options, server_options) with a \"-\"\nbefore the first variable, service_name, as above. Service options is a\ncomma separated list, server options will be appended as a string to\nthe individual server lines for a given listen stanza.\n\nIf your web application serves dynamic content based on users' login\nsessions, a visitor will experience unexpected behaviour if each request\nis proxied to a different backend web server. Session stickiness ensures\nthat a visitor 'sticks' to the backend web server which served their\nfirst request. This is made possible by tagging each backend server\nwith a cookie. Session are sticky by default. To turn off sticky sessions,\nremove the 'cookie SRVNAME insert' and 'cookie S{i}' stanzas from\n`service_options` and `server_options`.\n",
          "Default": "- service_name: haproxy_service\n  service_host: \"0.0.0.0\"\n  service_port: 80\n  service_options: [balance leastconn, cookie SRVNAME insert]\n  server_options: maxconn 100 cookie S{i} check\n"
        },
        "source": {
          "Type": "string",
          "Description": "Optional configuration to support use of additional sources such as:\n.\n- ppa:myteam/ppa\n- cloud:precise-proposed/folsom\n- http://my.archive.com/ubuntu main\n.\nThe last option should be used in conjunction with the key configuration\noption.\n",
          "Default": ""
        },
        "ssl_cert": {
          "Type": "string",
          "Description": "base64 encoded default SSL certificate. If the keyword 'SELFSIGNED'\nis used, the certificate and key will be autogenerated as\nself-signed. This is the certificate used by services configured\nusing keyword 'DEFAULT' as SSL certificate. This config key will be\nignored if the installed haproxy package has no SSL support.\n",
          "Default": ""
        },
        "ssl_key": {
          "Type": "string",
          "Description": "base64 encoded private key for the default SSL certificate. If ssl_cert\nis specified as SELFSIGNED or the installed haproxy package has no SSL\nsupport, this will be ignored.\n",
          "Default": ""
        },
        "sysctl": {
          "Type": "string",
          "Description": "YAML-formatted list of sysctl values, e.g.: '{ net.ipv4.tcp_max_syn_backlog : 65536 }'\n",
          "Default": ""
        }
      }
    },
    "charm-metadata": {
      "Name": "haproxy",
      "Summary": "fast and reliable load balancing reverse proxy",
      "Description": "HAProxy is a TCP/HTTP reverse proxy which is particularly suited for high availability environments. It features connection persistence through HTTP cookies, load balancing, header addition, modification, deletion both ways. It has request blocking capabilities and provides interface to display server status.",
      "Subordinate": false,
      "Provides": {
        "local-monitors": {
          "Name": "local-monitors",
          "Role": "provider",
          "Interface": "local-monitors",
          "Optional": false,
          "Limit": 0,
          "Scope": "container"
        },
        "munin": {
          "Name": "munin",
          "Role": "provider",
          "Interface": "munin-node",
          "Optional": false,
          "Limit": 0,
          "Scope": "global"
        },
        "nrpe-external-master": {
          "Name": "nrpe-external-master",
          "Role": "provider",
          "Interface": "nrpe-external-master",
          "Optional": false,
          "Limit": 0,
          "Scope": "container"
        },
        "statistics": {
          "Name": "statistics",
          "Role": "provider",
          "Interface": "statistics",
          "Optional": false,
          "Limit": 0,
          "Scope": "container"
        },
        "website": {
          "Name": "website",
          "Role": "provider",
          "Interface": "http",
          "Optional": false,
          "Limit": 0,
          "Scope": "global"
        }
      },
      "Requires": {
        "reverseproxy": {
          "Name": "reverseproxy",
          "Role": "requirer",
          "Interface": "http",
          "Optional": false,
          "Limit": 1,
          "Scope": "global"
        }
      },
      "Peers": {
        "peer": {
          "Name": "peer",
          "Role": "peer",
          "Interface": "haproxy-peer",
          "Optional": false,
          "Limit": 1,
          "Scope": "global"
        }
      },
      "Format": 1,
      "OldRevision": 0,
      "Tags": [
        "cache-proxy"
      ],
      "min-juju-version": "0.0.0"
    },
    "extra-info": {
      "bzr-digest": "cory.johns@canonical.com-20160407151443-52jh5xd6qqlsc9b1",
      "bzr-owner": "charmers",
      "bzr-revisions": [
        {
          "authors": [
            {
              "email": "adam.israel@gmail.com",
              "name": "Adam Israel"
            }
          ],
          "date": "2016-03-04T16:19:32Z",
          "message": "[samantha-jian] Add liberty support\n",
          "revno": 102
        },
        {
          "authors": [
            {
              "email": "adam.israel@gmail.com",
              "name": "Adam Israel"
            }
          ],
          "date": "2016-03-03T16:47:14Z",
          "message": "[aisrael] Fix lint error\n",
          "revno": 101
        },
        {
          "authors": [
            {
              "email": "marco@ceppi.net",
              "name": "Marco Ceppi"
            }
          ],
          "date": "2016-01-09T16:42:37Z",
          "message": "New icon",
          "revno": 100
        },
        {
          "authors": [
            {
              "email": "kevin.monroe@canonical.com",
              "name": "Kevin W. Monroe"
            }
          ],
          "date": "2015-11-19T18:13:44Z",
          "message": "[verterok, r=admcleod, a=kwmonroe] restart rsyslog if haproxy config changes; minor updates to tests",
          "revno": 99
        },
        {
          "authors": [
            {
              "email": "christopher.glass@canonical.com",
              "name": "Christopher Glass"
            }
          ],
          "date": "2015-10-21T15:47:19Z",
          "message": "Merge lp:~tribaal/charms/trusty/haproxy/longer-openssl-selfsigned [a=tribaal] [r=dpb]\n\nMake the self-signed SSL certificate last for 3650 days instead of the default of 30 days.\nThis mirrors what the apache charm does.\n",
          "revno": 98
        },
        {
          "authors": [
            {
              "email": "christopher.glass@canonical.com",
              "name": "Christopher Glass"
            }
          ],
          "date": "2015-08-18T11:06:48Z",
          "message": "Merge lp:~free.ekanayaka/charms/trusty/haproxy/no-sslv3 [a=free.ekanayaka] [r=tribaal]\n\nDisable SSL v3 to prevent POODLE attacks when SSL is enabled.\n",
          "revno": 97
        },
        {
          "authors": [
            {
              "email": "christopher.glass@canonical.com",
              "name": "Christopher Glass"
            }
          ],
          "date": "2015-08-18T07:47:28Z",
          "message": "Merge lp:~free.ekanayaka/charms/trusty/haproxy/ciphers-support [a=free.ekanayaka] [r=tribaal]\n\nAdd a config option to specify what ciphers to use when SSL is enabled.\nDefault to a sane selection of ciphers, in particular disallowing RC4 and null encryption.\n",
          "revno": 96
        },
        {
          "authors": [
            {
              "email": "charles.butler@canonical.com",
              "name": "Charles Butler"
            }
          ],
          "date": "2015-06-26T21:10:08Z",
          "message": "[r,a=lazypower]Junien Fridrick 2015-06-10 [mhilton] only open ports that aren't opened\nJunien Fridrick 2015-06-10 Add \"peering-mode\" option that allows \"active-passive\" mode or \"active-active\" mode.\n",
          "revno": 95
        },
        {
          "authors": [
            {
              "email": "dpb@canonical.com",
              "name": "David Britton"
            }
          ],
          "date": "2015-05-15T17:20:41Z",
          "message": "Merge lp:~danilo/charms/trusty/haproxy/merge-services-fix [r=bjornt,whitmo,davidpbritton]\n- Fig bug in backend service merge logic [lp:1455079]\n- Fix small lint, proof\n",
          "revno": 94
        },
        {
          "authors": [
            {
              "email": "tim.van.steenburgh@canonical.com",
              "name": "Tim Van Steenburgh"
            }
          ],
          "date": "2015-05-15T14:52:59Z",
          "message": "[cjwatson] Fix Nagios checks to handle haproxy 1.5.",
          "revno": 93
        }
      ],
      "bzr-url": "lp:~charmers/charms/trusty/haproxy/trunk",
      "legacy-download-stats": 29295
    },
    "manifest": [
      {
        "Name": "revision",
        "Size": 2
      },
      {
        "Name": "Makefile",
        "Size": 1187
      },
      {
        "Name": "README.md",
        "Size": 9500
      },
      {
        "Name": "charm-helpers.yaml",
        "Size": 58
      },
      {
        "Name": "cm.py",
        "Size": 6900
      },
      {
        "Name": "config-manager.txt",
        "Size": 179
      },
      {
        "Name": "config.yaml",
        "Size": 9576
      },
      {
        "Name": "copyright",
        "Size": 756
      },
      {
        "Name": "data/openssl.cnf",
        "Size": 509
      },
      {
        "Name": "files/metrics/haproxy_to_statsd.sh",
        "Size": 925
      },
      {
        "Name": "files/nrpe/check_haproxy.sh",
        "Size": 1178
      },
      {
        "Name": "files/nrpe/check_haproxy_queue_depth.sh",
        "Size": 967
      },
      {
        "Name": "hooks/charmhelpers/__init__.py",
        "Size": 1378
      },
      {
        "Name": "hooks/charmhelpers/contrib/__init__.py",
        "Size": 677
      },
      {
        "Name": "hooks/charmhelpers/contrib/charmsupport/__init__.py",
        "Size": 677
      },
      {
        "Name": "hooks/charmhelpers/contrib/charmsupport/nrpe.py",
        "Size": 12317
      },
      {
        "Name": "hooks/charmhelpers/contrib/charmsupport/volumes.py",
        "Size": 6022
      },
      {
        "Name": "hooks/charmhelpers/core/__init__.py",
        "Size": 677
      },
      {
        "Name": "hooks/charmhelpers/core/decorators.py",
        "Size": 1785
      },
      {
        "Name": "hooks/charmhelpers/core/fstab.py",
        "Size": 4282
      },
      {
        "Name": "hooks/charmhelpers/core/hookenv.py",
        "Size": 20113
      },
      {
        "Name": "hooks/charmhelpers/core/host.py",
        "Size": 13808
      },
      {
        "Name": "hooks/charmhelpers/core/services/__init__.py",
        "Size": 737
      },
      {
        "Name": "hooks/charmhelpers/core/services/base.py",
        "Size": 12876
      },
      {
        "Name": "hooks/charmhelpers/core/services/helpers.py",
        "Size": 9736
      },
      {
        "Name": "hooks/charmhelpers/core/strutils.py",
        "Size": 1356
      },
      {
        "Name": "hooks/charmhelpers/core/sysctl.py",
        "Size": 1770
      },
      {
        "Name": "hooks/charmhelpers/core/templating.py",
        "Size": 2603
      },
      {
        "Name": "hooks/charmhelpers/core/unitdata.py",
        "Size": 14161
      },
      {
        "Name": "hooks/charmhelpers/fetch/__init__.py",
        "Size": 15353
      },
      {
        "Name": "hooks/charmhelpers/fetch/archiveurl.py",
        "Size": 5856
      },
      {
        "Name": "hooks/charmhelpers/fetch/bzrurl.py",
        "Size": 2745
      },
      {
        "Name": "hooks/charmhelpers/fetch/giturl.py",
        "Size": 2391
      },
      {
        "Name": "hooks/config-changed",
        "Size": 10
      },
      {
        "Name": "hooks/hooks.py",
        "Size": 53851
      },
      {
        "Name": "hooks/install",
        "Size": 465
      },
      {
        "Name": "hooks/local-monitors-relation-joined",
        "Size": 10
      },
      {
        "Name": "hooks/munin-relation-changed",
        "Size": 666
      },
      {
        "Name": "hooks/nrpe-external-master-relation-joined",
        "Size": 8
      },
      {
        "Name": "hooks/peer-relation-changed",
        "Size": 10
      },
      {
        "Name": "hooks/peer-relation-joined",
        "Size": 10
      },
      {
        "Name": "hooks/reverseproxy-relation-broken",
        "Size": 10
      },
      {
        "Name": "hooks/reverseproxy-relation-changed",
        "Size": 10
      },
      {
        "Name": "hooks/reverseproxy-relation-departed",
        "Size": 8
      },
      {
        "Name": "hooks/reverseproxy-relation-joined",
        "Size": 8
      },
      {
        "Name": "hooks/start",
        "Size": 10
      },
      {
        "Name": "hooks/statistics-relation-changed",
        "Size": 8
      },
      {
        "Name": "hooks/statistics-relation-joined",
        "Size": 8
      },
      {
        "Name": "hooks/stop",
        "Size": 10
      },
      {
        "Name": "hooks/tests/__init__.py",
        "Size": 0
      },
      {
        "Name": "hooks/tests/test_config_changed_hooks.py",
        "Size": 7482
      },
      {
        "Name": "hooks/tests/test_helpers.py",
        "Size": 35275
      },
      {
        "Name": "hooks/tests/test_install.py",
        "Size": 3483
      },
      {
        "Name": "hooks/tests/test_metrics.py",
        "Size": 2951
      },
      {
        "Name": "hooks/tests/test_nrpe_hooks.py",
        "Size": 828
      },
      {
        "Name": "hooks/tests/test_peer_hooks.py",
        "Size": 11029
      },
      {
        "Name": "hooks/tests/test_reverseproxy_hooks.py",
        "Size": 23485
      },
      {
        "Name": "hooks/tests/test_statistics_hooks.py",
        "Size": 2417
      },
      {
        "Name": "hooks/tests/test_upgrade_charm.py",
        "Size": 704
      },
      {
        "Name": "hooks/tests/test_website_hooks.py",
        "Size": 5842
      },
      {
        "Name": "hooks/tests/utils_for_tests.py",
        "Size": 533
      },
      {
        "Name": "hooks/upgrade-charm",
        "Size": 8
      },
      {
        "Name": "hooks/website-relation-changed",
        "Size": 10
      },
      {
        "Name": "hooks/website-relation-joined",
        "Size": 10
      },
      {
        "Name": "icon.svg",
        "Size": 20752
      },
      {
        "Name": "metadata.yaml",
        "Size": 883
      },
      {
        "Name": "setup.cfg",
        "Size": 61
      },
      {
        "Name": "tarmac_tests.sh",
        "Size": 75
      },
      {
        "Name": "templates/metrics_cronjob.template",
        "Size": 392
      },
      {
        "Name": "templates/nrpe_service.tmpl",
        "Size": 481
      },
      {
        "Name": "tests/00_setup.sh",
        "Size": 356
      },
      {
        "Name": "tests/10_deploy_test.py",
        "Size": 6122
      },
      {
        "Name": "tests/default_apache.tmpl",
        "Size": 960
      }
    ],
    "published": {
      "Info": [
        {
          "Channel": "stable",
          "Current": true
        }
      ]
    },
    "resources": [],
    "stats": {
      "ArchiveDownloadCount": 29476,
      "ArchiveDownload": {
        "Total": 29476,
        "Day": 1,
        "Week": 36,
        "Month": 163
      },
      "ArchiveDownloadAllRevisions": {
        "Total": 37776,
        "Day": 23,
        "Week": 413,
        "Month": 2205
      }
    },
    "supported-series": {
      "SupportedSeries": [
        "trusty"
      ]
    },
    "tags": {
      "Tags": [
        "cache-proxy"
      ]
    }
  }
}
